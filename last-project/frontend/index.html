<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ana Sehife</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div class="container-fluid">
        <button class="btn btn-primary" data-toggle="modal" data-target="#loginModal">Hesaba daxil ol</button>
        <button class="btn btn-secondary" data-toggle="modal" data-target="#signupModal">Hesab yarat</button>
        <hr>

        <center>
        <div style="margin: auto; align-items: center;">

            <div id="demo" class="carousel slide" style="width: 60%;" data-ride="carousel">

                <!-- Indicators -->
                <ul class="carousel-indicators">
                  <li data-target="#demo" data-slide-to="0" class="active"></li>
                  <li data-target="#demo" data-slide-to="1"></li>
                  <li data-target="#demo" data-slide-to="2"></li>
                  <li data-target="#demo" data-slide-to="3"></li>
                  <li data-target="#demo" data-slide-to="4"></li>
                </ul>
              
                <!-- The slideshow -->
                <div class="carousel-inner" style="width: 500px; margin: auto;" >
                  <div class="carousel-item active">
                    <img src="images/acer-1.jpg" alt="Los Angeles">
                  </div>
                  <div class="carousel-item">
                    <img src="images/acer-2.jpg" alt="Chicago">
                  </div>
                  <div class="carousel-item">
                    <img src="images/asus-1.jpg" alt="New York">
                  </div>
                  <div class="carousel-item">
                    <img src="images/asus-2.png" alt="New York">
                  </div>
                  <div class="carousel-item">
                    <img src="images/hp-1.png" alt="New York">
                  </div>
                </div>
              
                <!-- Left and right controls -->
                <a class="carousel-control-prev bg-dark" href="#demo" data-slide="prev">
                  <span class="carousel-control-prev-icon"></span>
                </a>
                <a class="carousel-control-next bg-dark" href="#demo" data-slide="next">
                  <span class="carousel-control-next-icon"></span>
                </a>
              
              </div>

        </div>
    </center>

        
    <div class="modal fade" id="loginModal">
        <div class="modal-dialog">
          <div class="modal-content">
          
            <!-- Modal Header -->
            <div class="modal-header">
              <h4 class="modal-title">Hesaba daxil ol</h4>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            
            <!-- Modal body -->
            <div class="modal-body">
              <form onsubmit="onLogin(event)">
                <div class="form-group">
                    <label for="username">Istifadeci adi:</label>
                    <input type="text" class="form-control" placeholder="Istifadeci adinizi yazin..." id="username">
                </div>
                <div class="form-group">
                    <label for="password">Sifre:</label>
                    <input type="password" class="form-control" placeholder="Sifrenizi yazin..." id="password">
                </div>
                <button type="submit" class="btn btn-primary">Daxil ol</button>
            </form>
            </div>
            
          </div>
        </div>
      </div>






      <div class="modal fade" id="signupModal">
        <div class="modal-dialog">
          <div class="modal-content">
          
            <!-- Modal Header -->
            <div class="modal-header">
              <h4 class="modal-title">Hesab yarat</h4>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            
            <!-- Modal body -->
            <div class="modal-body">
              <form onsubmit="onSignup(event)">
                <div class="form-group">
                    <label for="newUsername">Istifadeci adi:</label>
                    <input type="text" class="form-control" placeholder="Istifadeci adinizi yazin..." id="newUsername">
                </div>
                <div class="form-group">
                    <label for="newPassword">Sifre:</label>
                    <input type="password" class="form-control" placeholder="Sifrenizi yazin..." id="newPassword">
                </div>
                <button type="submit" class="btn btn-primary">Hesab yarat</button>
            </form>
            </div>
            
          </div>
        </div>
      </div>


      

    </div>

    <script>
        var token = "Basic " + window.btoa(localStorage.getItem('username')+":"+localStorage.getItem('password'));

        var loggedIn = localStorage.getItem('loggedIn');
        if(loggedIn){

        }

        var usernameInput = document.getElementById('username');
        var passwordInput = document.getElementById('password');
        var newUsernameInput = document.getElementById('newUsername');
        var newPasswordInput = document.getElementById('newPassword');

        function onLogin(event){
            event.preventDefault();
            var username = usernameInput.value;
            var password = passwordInput.value;

            var http = new XMLHttpRequest();

            http.onload = function(){
                if(this.status==401){
                    alert("Melumatlar sehvdir!");
                } else if(this.status==200){
                    localStorage.setItem('username',username);
                    localStorage.setItem('password',password);
                    window.location.href = "computers.html";
                    localStorage.setItem('loggedIn',true);
                }
            }

            http.open("GET","http://localhost:8053/users/login",true);
            http.setRequestHeader("Authorization","Basic "+window.btoa(username+":"+password));
            http.send();
        }

        function onSignup(event){
            event.preventDefault();
            var newUsername = newUsernameInput.value;
            var newPassword = newPasswordInput.value;

            var http = new XMLHttpRequest();

            http.onload = function(){
                var response = JSON.parse(this.responseText);
                if(response.username==""){
                    alert('Bu istifadeci adi artiq movcuddur!!!');
                } else{
                    alert('Success');
                }
            }

            var userObj = {};
            userObj.username = newUsername;
            userObj.password = newPassword;

            http.open("POST","http://localhost:8053/users/signup",true);
            http.setRequestHeader("Content-Type","application/json");
            http.send(JSON.stringify(userObj));
        }

    </script>
    
</body>
</html>